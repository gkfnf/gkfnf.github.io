<!DOCTYPE html>
<html>

<head>
  <title> CVE-2018-20250 --&gt; WinRAR RCE &middot; Fkbug </title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.51" />




<link rel="stylesheet" href="/css/vec.min.css">

<link rel="stylesheet" href="/css/prism.css">

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/favicon.ico">


<link href="" rel="alternate" type="application/rss+xml" title="Fkbug" />




<script src="/js/prism.js" async="" ></script>


<script src="/js/btn.js" async=""></script>


</head>

<body>
  <header>
  <nav>
    <ul>
      
      
      
      
      <li class="pull-left">
        <a href="/post/cve201820250/"><i class="fas fa-list-ul" id="toc_btn"></i></a>
      </li>
      <li class="pull-left">
        <a href="https://fkbug.com">fkbug</a>
      </li>
      
      
      <li class="pull-left">
        <a href="/categories">post</a>
      </li>
      
      <li class="pull-right">
        <a href=""><i class="fas fa-lightbulb" id="bulb_btn"></i></a>
      </li>
    </ul>
  </nav>
</header>

  <div class="content wide">
    
    
    <section class="post">
      <h1 class="post-title"><a href="https://fkbug.com/post/cve201820250/">CVE-2018-20250 --&gt; WinRAR RCE</a></h1>
      <span class="post-date">Jan 1, 0001 </span>
      <div class="post-content">
        

<h2 id="效果">效果</h2>

<blockquote>
<p>当对恶意的 <code>.rar</code> 压缩包进行 <strong>双击解压</strong> 或 <strong>解压到当前目录</strong> 时，恶意的压缩包可以释放恶意文件到<code>Windows</code>系统启动项， 在系统 <strong>重启后执行任意代码</strong>。</p>
</blockquote>

<p><strong>Ref:</strong> &nbsp; <a href="https://research.checkpoint.com/extracting-code-execution-from-winrar/">https://research.checkpoint.com/extracting-code-execution-from-winrar/</a></p>

<p>受影响版本:  <code>Version</code> <strong>&lt; 5.70</strong></p>

<h2 id="成因">成因</h2>

<blockquote>
<p>WinRar  解析 <strong>ACE</strong> 压缩格式的库 <strong>UNACEV2.dll</strong> 自从 19 年前就没更新过了, 而该库未开启 <strong>ASLR</strong> 及 <strong>DEP</strong> 等保护措施，且 <strong>对文件路径的处理逻辑</strong> 存在安全隐患</p>
</blockquote>

<p>背景知识：







  <iframe
    class="shengxiang"
    width="800"
    height="450"
    scrolling="no"
    frameborder="0"
    allowfullscreen
    src="https://ppt.baomitu.com/embed/adab6b4a?style=dark">
  </iframe>


</p>

<p>我们来看一下 <strong>UNACEV2.dll</strong> :</p>

      </div>
    </section>
    
    <section class="pagination clearfix">
       
      
    </section>
    
    
  </div>
  
  <footer>
<script src="//yihui.name/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  <div class="footer-info">
    <p>
      <a href="mailto:978694661@qq.com?subject="><i class="far fa-envelope"></i> Fkbug</a>
      |
        <a href="https://gohugo.io/" title="Hugo :: A fast and modern static website engine">0.51  </a>|
        <a href="https://github.com/gkfnf/gkfnf.github.io" title="Fk">Fk</a>  
      |
      <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/" title="CC BY-NC-ND 3.0">CC BY-NC-ND 3.0</a>
    </p>
  </div>
</footer>
  

  

</body>

</html>
